foremost2.*版本基于foremost1.5.7版本修改，添加了从pcap文件中提取文件的功能。
原foremost不支持pcap格式文件，tcpxtract支持pcap格式，但是功能不如foremost，且提取速度比较慢。

测试：
i5 + 8G内存 + 普通硬盘
1.7GB的pcap文件使用foremost -a -v参数提取所有类型，提取了46730个文件，共187M，花费28秒.


FOREMOST 
----------------------------------------------------------------------

Foremost is a Linux program to recover files based on their headers and
footers. Foremost can work on image files, such as those generated by dd,
Safeback, Encase, etc, or directly on a drive. The headers and footers are
specified by a configuration file, so you can pick and choose which
headers you want to look for.



--------------------------------------------
INSTALL FOREMOST
--------------------------------------------

To run foremost, you must:

- install libpcap-dev
- uncompress the archive
- compile
- install

Here's how to do it:

LINUX:
$ tar zxvf foremost-xx.tar.gz
$ cd foremost-xx
$ make
$ make install

BSD:
$ tar zxvf foremost-xx.tar.gz
$ cd foremost-xx
$ make unix
$ make install

SOLARIS:
$ tar zxvf foremost-xx.tar.gz
$ cd foremost-xx
$ make solaris
$ make install

OSX:
$ tar zxvf foremost-xx.tar.gz
$ cd foremost-xx
$ make mac
$ make macinstall

On systems with older versions of glibc (earlier than 2.2.0), you will get 
some harmless warnings about ftello and fseeko not being defined. You can 
ignore these.


If you ever need to remove foremost from your system, you can do this:

$ make uninstall



--------------------------------------------
USING FOREMOST
--------------------------------------------

A description of the command line arguments can be found in the man page. 
To view it:

$ man foremost

--------------------------------------------
TEST
--------------------------------------------
$ wget http://forensicscontest.com/contest01/evidence01.pcap
$ foremost -a -v -p -Q -i pcap/evidence01.pcap pcap/evidence01_bak.pcap
extract from pcap file
Current state:
Config file: (null)
Output directory: /output
Mode: 38
Foremost version 2.0.2 by Jesse Kornblum, Kris Kendall, and Nick Mikus, NKAMG Team
Audit File

Foremost started at Thu Nov 16 15:41:01 2017
Invocation: foremost -a -v -p -Q -i pcap/evidence01.pcap pcap/evidence01_bak.pcap
Output directory: /output
input file : pcap/evidence01.pcap

205.188.13.12:443->205.188.13.12:1271
0:	00000004.zip 	       1 KB 	       2307 	  (Header dump)
205.188.13.12:443->205.188.13.12:1271
1:	00000007.zip 	       1 KB 	       3660 	  (Header dump)
...

input file : pcap/evidence01_bak.pcap
205.188.13.12:443->205.188.13.12:1271
32:	00000004_1.zip 	       1 KB 	       2307 	  (Header dump)
205.188.13.12:443->205.188.13.12:1271
33:	00000007_1.zip 	       1 KB 	       3660 	  (Header dump)
...

64 FILES EXTRACTED
	
gif:= 10
htm:= 6
zip:= 48

$ ls output/zip/
192.168.1.158_5190_192.168.1.158_1272_00000003_1.zip  205.188.13.12_443_205.188.13.12_1271_00000016_1.zip
192.168.1.158_5190_192.168.1.158_1272_00000003.zip    205.188.13.12_443_205.188.13.12_1271_00000016.zip
192.168.1.158_5190_192.168.1.158_1272_00000006_1.zip  205.188.13.12_443_205.188.13.12_1271_00000018_1.zip
192.168.1.158_5190_192.168.1.158_1272_00000006.zip    205.188.13.12_443_205.188.13.12_1271_00000018.zip
192.168.1.158_5190_192.168.1.158_1272_00000009_1.zip  205.188.13.12_443_205.188.13.12_1271_00000021_1.zip

$ cat output/getfiles.log 
#separator \x09
#Foremost started at Thu Nov 16 17:10:23 2017
#Invocation: foremost/foremost -a -v -p -Q -i pcap/evidence01.pcap pcap/evidence01_bak.pcap 
#Output directory: /work/amg/extract_file_from_pcap/output
#
#
#fields	ts	id.orig_h	id.orig_p	id.resp_h	id.resp_p	save_filename	file_bytes	input_file	stream_offset	comment
#types	time	addr	port	addr	port	string	count	string	count	string
1250143057.923003	205.188.13.12	443	205.188.13.12	1271	00000004.zip	1322	pcap/evidence01.pcap	2307	 (Header dump)
1250143058.129370	205.188.13.12	443	205.188.13.12	1271	00000007.zip	1329	pcap/evidence01.pcap	3660	 (Header dump)
...

--------------------------------------------
CONFIGURATION FILE FORMAT
--------------------------------------------

The configuration file is used to control what types of files foremost
searches for. A sample configuration file, foremost.conf, is included with
this distribution. For each file type, the configuration file describes
the file's extension, whether the header and footer are case sensitive,
the maximum file size, and the header and footer for the file. The footer
field is optional, but header, size, case sensitivity, and extension are
not!

Any line that begins with a '#' is considered a comment and ignored. Thus,
to skip a file type just put a '#' at the beginning of that line

Headers and footers are decoded before use. To specify a value in
hexadecimal use \x[0-f][0-f], and for octal use \[1-9][1-9][1-9].  Spaces
can be represented by \s. Example: "\x4F\123\I\sCCI" decodes to "OSI CCI".

To match any single character (aka a wildcard) use a '?'. If you need to
search for the '?' character, you will need to change the 'wildcard' line
*and* every occurrence of the old wildcard character in the configuration
file. Don't forget those hex and octal values! '?' is equal to 0x3f and
\063.

Here's a sample set of headers and footers:

# extension  case-sens  max-size   header			footer		(option)
#
# GIF and JPG files (very common)
	gif	y	155000	\x47\x49\x46\x38\x37\x61	\x00\x3b
  	gif	y 	155000	\x47\x49\x46\x38\x39\x61	\x00\x00\x3b
  	jpg	y	200000	\xff\xd8\xff			\xff\xd9

Note: the option is a method of specifying additional options.  Current the following options exist:

FORWARD: Specify to search from the header to the footer (optional) up to the max-size.
REVERSE: Specify to search from the footer to the header up to the max-size.
NEXT: Specify to search from the header to the data just past the footer.  This allows you to  specify data that you know is 'NOT' in the data you are looking for and should terminated the search, up to the max-size.

--------------------------------------------
BUG REPORTING
--------------------------------------------

Please report ALL bugs to nick dot mikus AT gmail d0t com. Please include a 
description of the bug, how you found it, and your contact information.




--------------------------------------------
CREDITS AND THANKS
--------------------------------------------

Foremost was written by Special Agent Kris Kendall and Special Agent Jesse
Kornblum of the United States Air Force Office of Special Investigations
starting in March 2001. This program would not be what it is today without
help from (in no particular order): Rob Meekins, Dan Kalil, and Chet
Maciag. This project was inspired by CarvThis, written by the Defense
Computer Forensic Lab in 1999.


--------------------------------------------
LEGAL NOTICE
--------------------------------------------

dd, Safeback, and Encase are copyrighted works and any questions regarding 
these tools should be directed to the copyright holders. The United States 
Government does not endorse the use of these or any other imaging tools. 
