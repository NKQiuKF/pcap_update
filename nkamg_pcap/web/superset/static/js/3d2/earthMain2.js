function controlsFunc(){$("#leftCtlMin").click(function(){var f=$("#leftCtlMin");var d=$("#leftCtl");var b=parseInt(f.css("right"));var c=parseFloat(f.css("width"));var a=parseFloat(d.css("width"));var e=a-2*b-c;if(d.attr("data-trig")=="1"){d.animate({"left":-1*e+"px"},200);d.attr("data-trig","0")}else{d.animate({"left":"0"},200);d.attr("data-trig","1")}});$("#panelMin").click(function(){var b=$("#panelMin");var d=$("#panel");var f=parseInt(b.css("top"));var a=parseFloat(b.css("height"));var c=parseFloat(d.css("height"));var e=c-2*f-a;if(d.attr("data-trig")=="1"){d.animate({"bottom":-1*e+"px"},200);d.attr("data-trig","0");$(this).find("i").attr("class","icon-angle-up")}else{d.animate({"bottom":"0"},200);d.attr("data-trig","1");$(this).find("i").attr("class","icon-angle-down")}})}function initPlanet(g){var e={};var b=document.getElementById("mapCanvas");var a=planetaryjs.planet();e.planet=a;a.loadPlugin(c({extraHeight:-120}));a.loadPlugin(d({extraHeight:-120}));a.loadPlugin(planetaryjs.plugins.earth({topojson:{file:"../../static/json/world-110m.json"},oceans:{shadowColor:"#66ccff",shadowBlur:60},graticule:{stroke:"#4bffff"}}));a.loadPlugin(planetaryjs.plugins.myWorld2({fill:"#a5a5a5",stroke:"#7c7c7c",lineWidth:0.1}));a.loadPlugin(planetaryjs.plugins.pings());a.loadPlugin(planetaryjs.plugins.lines());a.loadPlugin(planetaryjs.plugins.dots());a.loadPlugin(planetaryjs.plugins.fixLines());a.loadPlugin(planetaryjs.plugins.zoom({scaleExtent:[1,90000]}));a.loadPlugin(planetaryjs.plugins.drag({onDragStart:function(){this.plugins.autorotate.pause()},onDragEnd:function(){this.plugins.autorotate.resume()}}));a.loadPlugin(f(5));a.projection.rotate([240,-30,0]);a.draw(b);e.countryInfo=a.plugins.myWorld.countryInfo;e.stopRotate=function(){a.plugins.autorotate.pause()};e.startRotate=function(){a.plugins.autorotate.resume()};d3.select("#stop").on("click",function(){a.stop()});d3.select("#addPing").on("click",function(){a.plugins.pings.add({angle:angles(9),color:"red",ttl:ttls(4),lineWidth:5,lat:40,lng:116})});d3.select("#addLine").on("click",function(){a.plugins.lines.add({color:"green",ttl:ttls(4),lat0:40,lng0:116,lat1:0,lng1:0})});e.addDot=function(h){a.plugins.dots.add(h)};e.attack=function(h){h.circle.angle=h.circle.angle||10;h.line.lineWidth=h.line.lineWidth||3;h.circle.lineWidth=h.circle.lineWidth||3;h.src.lng=(h.src.lng+180)%360-180;h.src.lat=(h.src.lat+90)%180-90;h.dst.lng=(h.dst.lng+180)%360-180;h.dst.lat=(h.dst.lat+90)%180-90;a.plugins.pings.add({angles:h.circle.angle,color:h.color,lineWidth:h.circle.lineWidth||5,ttl:h.circle.ttl,lat:h.src.lat,lng:h.src.lng,});a.plugins.lines.add({color:h.color,ttl:h.line.ttl,lat0:h.src.lat,lng0:h.src.lng,lat1:h.dst.lat,lng1:h.dst.lng,lineWidth:h.line.lineWidth||1});setTimeout(function(){a.plugins.pings.add({angles:h.circle.angle,color:h.color,lineWidth:h.circle.lineWidth||5,ttl:h.circle.ttl,lat:h.dst.lat,lng:h.dst.lng})},h.line.ttl-400)};e.fixLine=function(h){a.plugins.fixLines.add(h)};e.showGraticule=function(){a.plugins.graticule.changeGraticule(true)};e.hideGraticule=function(){a.plugins.graticule.changeGraticule(false)};e.colors=d3.scale.pow().exponent(3).domain([2,4,6,8,10]).range(["white","yellow","orange","red","purple"]);e.angles=d3.scale.pow().exponent(3).domain([2.5,10]).range([0.5,15]);e.ttls=d3.scale.pow().exponent(3).domain([2.5,10]).range([2000,5000]);function c(j){j=j||{};var i=false;var k=null;var h=function(){var m=window.innerWidth+(j.extraWidth||0);var l=window.innerHeight+(j.extraHeight||0);k.canvas.width=m;k.canvas.height=l+115;k.projection.translate([m/2,l/2])};return function(l){k=l;l.onInit(function(){i=true;d3.select(window).on("resize",function(){i=true})});l.onDraw(function(){if(i){h();i=false}})}}function d(h){h=h||{};return function(i){i.onInit(function(){var k=window.innerWidth+(h.extraWidth||0);var j=window.innerHeight+(h.extraHeight||0);i.projection.scale(Math.min(k,j)/2)})}}function f(h){return function(i){var k=null;var j=false;i.plugins.autorotate={pause:function(){j=true},resume:function(){j=false}};i.onDraw(function(){if(j||!k){k=new Date()}else{var l=new Date();var n=l-k;var m=i.projection.rotate();m[0]+=h*n/1000;if(m[0]>=180){m[0]-=360}i.projection.rotate(m);k=l}})}}return e}function simulationAttack(a){setInterval(function(){a.attack({src:{lat:Math.random()*360-180,lng:Math.random()*180-90},dst:{lat:Math.random()*360-180,lng:Math.random()*180-90},color:"red",circle:{ttl:800,lineWidth:4},line:{ttl:1600,lineWidth:4}})},1000)};
